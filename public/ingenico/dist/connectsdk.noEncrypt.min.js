!function(t){var o;"undefined"==typeof define&&(o={},t.define=function(t,e,n){if(e&&e.length)for(var i=0;i<e.length;i++){var r=o[e[i]];void 0===r&&"require"!==e[i]&&"exports"!==e[i]&&console.warn(`Could not find dependency '${e[i]}' of module '${t}'`),e[i]=r}o[t]=n.apply(this,e||[])},t.define("node-forge",[],function(){return t.forge||{}})),"undefined"==typeof exports&&t.define("exports",[],function(){return{}})}("undefined"==typeof window?this:window);var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();define("connectsdk.apimodel",["require","exports"],function(t,e){"use strict";e.__esModule=!0}),define("connectsdk.LabelTemplateElement",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.attributeKey=t.attributeKey,this.mask=t.mask,this.wildcardMask=t.mask?t.mask.replace(/9/g,"*"):""}}),define("connectsdk.AccountOnFileDisplayHints",["require","exports","connectsdk.LabelTemplateElement"],function(t,e,s){"use strict";return function(t){this.json=t,this.logo=t.logo,this.labelTemplate=[],this.labelTemplateElementByAttributeKey={},function(t,e,n){if(t.labelTemplate)for(var i=0,r=t.labelTemplate;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.attributeKey]=o}}(t,this.labelTemplate,this.labelTemplateElementByAttributeKey)}}),define("connectsdk.Attribute",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.key=t.key,this.value=t.value,this.status=t.status,this.mustWriteReason=t.mustWriteReason}}),define("connectsdk.MaskedString",["require","exports"],function(t,e){"use strict";return function(t,e){this.formattedValue=t,this.cursorIndex=e}}),define("connectsdk.MaskingUtil",["require","exports","connectsdk.MaskedString"],function(t,e,h){"use strict";function n(){}return n.prototype.applyMask=function(t,e,n){var i=[],r=e.split("");if(t){for(var o=[],s=0,a=t.split("");s<a.length;s++)"{"===(d=a[s])||"}"===d||o.push(d);!function t(e,n,i,r,o){e+n<o.length&&e<r.length&&("9"===r[e]&&-1<Number(o[e+n])&&" "!==o[e+n]||"*"===r[e]||o[e+n]===r[e]?i.push(o[e+n]):"9"!==r[e]&&"*"!==r[e]?(i.push(r[e]),n--):(o.splice(e+n,1),e--),t(e+1,n,i,r,o))}(0,0,i,o,r)}else for(var c=0,u=r;c<u.length;c++){var d=u[c];i.push(d)}e=i.join("");var l=1;if(n)for(var p=n.split(""),y=0,f=i.length;y<f;y++)if(i[y]!==p[y]){l=y+1;break}return e.substring(0,e.length-1)===n&&(l=e.length+1),new h(e,l)},n.prototype.getMaxLengthBasedOnMask=function(t){if(t){for(var e=-1,n=0,i=t.split("");n<i.length;n++){var r=i[n];e++,"{"!==r&&"}"!==r||e--}return e}return-1},n.prototype.removeMask=function(t,e){var n=[],i=e?e.split(""):[];if(t)for(var r=-1,o=!1,s=0,a=t.split("");s<a.length;s++)r++,"{"===(d=a[s])||"}"===d?(r--,"{"===d?o=!0:"}"===d&&(o=!1)):o&&i[r]&&n.push(i[r]);else for(var c=0,u=i;c<u.length;c++){var d=u[c];n.push(d)}return n.join("").trim()},n}),define("connectsdk.AccountOnFile",["require","exports","connectsdk.AccountOnFileDisplayHints","connectsdk.Attribute","connectsdk.MaskingUtil"],function(t,e,n,s,i){"use strict";function r(t){this.json=t,this.attributes=[],this.attributeByKey={},this.displayHints=new n(t.displayHints),this.id=t.id,this.paymentProductId=t.paymentProductId,function(t,e,n){if(t.attributes)for(var i=0,r=t.attributes;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.key]=o}}(t,this.attributes,this.attributeByKey)}return r.prototype.getMaskedValueByAttributeKey=function(t){var e,n=this.attributeByKey[t].value;try{e=this.displayHints.labelTemplateElementByAttributeKey[t].wildcardMask}catch(t){}if(void 0!==n&&void 0!==e)return(new i).applyMask(e,n)},r}),define("connectsdk.promise",["require","exports"],function(t,e){"use strict";function n(t){var n=this;this.isSingleton=t||!1;var i=[];function e(t,e){for(;i[0];){var n=i.shift()[t];n&&n(e)}}this.resolve=function(t){e("resolve",t)},this.reject=function(t){e("reject",t)},this.then=function(t,e){return i.push({resolve:t,reject:e}),n}}return n.resolve=function(t){var e=new n;return setTimeout(function(){return e.resolve(t)},0),e},n.reject=function(t){var e=new n;return setTimeout(function(){return e.reject(t)},0),e},n}),define("connectsdk.types",["require","exports"],function(t,e){"use strict";e.__esModule=!0}),define("connectsdk.Util",["require","exports"],function(t,e){"use strict";var n;return{getInstance:function(){return n=n||{applePayPaymentProductId:302,googlePayPaymentProductId:320,bancontactPaymentProductId:3012,paymentProductsThatAreNotSupportedInThisBrowser:[],getMetadata:function(){return{screenSize:window.innerWidth+"x"+window.innerHeight,platformIdentifier:window.navigator.userAgent,sdkIdentifier:(document.GC&&document.GC.rppEnabledPage?"rpp-":"")+"JavaScriptClientSDK/v4.1.0",sdkCreator:"Ingenico"}},collectDeviceInformation:function(){return{timezoneOffsetUtcMinutes:(new Date).getTimezoneOffset(),locale:navigator.language,browserData:{javaScriptEnabled:!0,javaEnabled:navigator.javaEnabled(),colorDepth:screen.colorDepth,screenHeight:screen.height,screenWidth:screen.width,innerHeight:window.innerHeight,innerWidth:window.innerWidth}}},base64Encode:function(t){if("object"==typeof t)try{t=JSON.stringify(t)}catch(t){throw"data must be either a String or a JSON object"}if(!t)return t;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=0,i=0,r=[];do{var o=t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<8|t.charCodeAt(n++),s=o>>12&63,a=o>>6&63,c=63&o}while(r[i++]=e.charAt(o>>18&63)+e.charAt(s)+e.charAt(a)+e.charAt(c),n<t.length);var u=r.join(""),d=t.length%3;return(d?u.slice(0,d-3):u)+"===".slice(d||3)},filterOutProductsThatAreNotSupportedInThisBrowser:function(t){for(var e=t.paymentProducts.length-1;0<=e;e--){var n=t.paymentProducts[e];n&&-1<this.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(n.id)&&t.paymentProducts.splice(e,1)}}}}}}),define("connectsdk.ApplePay",["require","exports","connectsdk.promise","connectsdk.Util"],function(t,e,o,n){"use strict";var i=n.getInstance();function r(){}return r.prototype.isApplePayAvailable=function(){var t=window.ApplePaySession&&window.ApplePaySession.canMakePayments();return t||i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.applePayPaymentProductId),!!t},r.prototype.initPayment=function(e,n){var i=new o,t=e.acquirerCountry||e.countryCode,t={currencyCode:e.currency,countryCode:t,total:{label:e.displayName,amount:(e.totalAmount/100).toString()},supportedNetworks:e.networks,merchantCapabilities:["supports3DS"]},r=new ApplePaySession(1,t);return r.begin(),r.onvalidatemerchant=function(t){t={displayName:e.displayName,validationURL:t.validationURL,domainName:window.location.hostname};n.createPaymentProductSession(302,t).then(function(t){try{r.completeMerchantValidation(JSON.parse(t.paymentProductSession302SpecificOutput.sessionObject))}catch(t){i.reject(t),r.abort()}},function(t){i.reject(t),r.abort()})},r.onpaymentauthorized=function(t){var e;t.payment.token?(e=ApplePaySession.STATUS_SUCCESS,i.resolve({message:"Payment authorized",data:t.payment.token}),r.completePayment(e)):(e=ApplePaySession.STATUS_FAILURE,i.reject({message:"Error payment authorization"}),r.completePayment(e))},i},r}),define("connectsdk.AuthenticationIndicator",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.name=t.name,this.value=t.value}}),define("connectsdk.PaymentProduct302SpecificData",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.networks=t.networks}}),define("connectsdk.PaymentProduct320SpecificData",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.gateway=t.gateway,this.networks=t.networks}}),define("connectsdk.PaymentProduct863SpecificData",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.integrationTypes=t.integrationTypes}}),define("connectsdk.PaymentProductDisplayHints",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.displayOrder=t.displayOrder,this.label=t.label,this.logo=t.logo}}),define("connectsdk.BasicPaymentProduct",["require","exports","connectsdk.AccountOnFile","connectsdk.AuthenticationIndicator","connectsdk.PaymentProduct302SpecificData","connectsdk.PaymentProduct320SpecificData","connectsdk.PaymentProduct863SpecificData","connectsdk.PaymentProductDisplayHints"],function(t,e,s,n,i,r,o,a){"use strict";function c(t){this.json=t,this.type="product",this.json.type="product",this.accountsOnFile=[],this.accountOnFileById={},this.allowsRecurring=t.allowsRecurring,this.allowsTokenization=t.allowsTokenization,this.autoTokenized=t.autoTokenized,this.allowsInstallments=t.allowsInstallments,this.acquirerCountry=t.acquirerCountry,this.canBeIframed=t.canBeIframed,this.deviceFingerprintEnabled=t.deviceFingerprintEnabled,this.displayHints=new a(t.displayHints),this.id=t.id,this.isJavaScriptRequired=t.isJavaScriptRequired,this.maxAmount=t.maxAmount,this.minAmount=t.minAmount,this.paymentMethod=t.paymentMethod,this.mobileIntegrationLevel=t.mobileIntegrationLevel,this.usesRedirectionTo3rdParty=t.usesRedirectionTo3rdParty,this.paymentProductGroup=t.paymentProductGroup,this.supportsMandates=t.supportsMandates,t.authenticationIndicator&&(this.authenticationIndicator=new n(t.authenticationIndicator)),t.paymentProduct302SpecificData&&(this.paymentProduct302SpecificData=new i(t.paymentProduct302SpecificData)),t.paymentProduct320SpecificData&&(this.paymentProduct320SpecificData=new r(t.paymentProduct320SpecificData)),t.paymentProduct863SpecificData&&(this.paymentProduct863SpecificData=new o(t.paymentProduct863SpecificData)),function(t,e,n){if(t.accountsOnFile)for(var i=0,r=t.accountsOnFile;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.id]=o}}(t,this.accountsOnFile,this.accountOnFileById)}return c.prototype.copy=function(){return new c(JSON.parse(JSON.stringify(this.json)))},c}),define("connectsdk.BasicPaymentProductGroup",["require","exports","connectsdk.AccountOnFile","connectsdk.PaymentProductDisplayHints"],function(t,e,s,n){"use strict";function i(t){this.json=t,this.type="group",this.json.type="group",this.id=t.id,this.allowsInstallments=t.allowsInstallments,this.displayHints=new n(t.displayHints),this.accountsOnFile=[],this.accountOnFileById={},function(t,e,n){if(t.accountsOnFile)for(var i=0,r=t.accountsOnFile;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.id]=o}}(t,this.accountsOnFile,this.accountOnFileById)}return i.prototype.copy=function(){return new i(JSON.parse(JSON.stringify(this.json)))},i}),define("connectsdk.BasicPaymentItem",["require","exports"],function(t,e){"use strict";e.__esModule=!0}),define("connectsdk.BasicPaymentProductGroups",["require","exports","connectsdk.BasicPaymentProductGroup"],function(t,e,l){"use strict";return function(t){this.json=t,this.basicPaymentProductGroups=[],this.basicPaymentProductGroupById={},this.accountsOnFile=[],this.accountOnFileById={},function(t,e,n,i,r){if(t.paymentProductGroups)for(var o=0,s=t.paymentProductGroups;o<s.length;o++){var a=s[o],a=new l(a);if(e.push(a),(i[a.id]=a).accountsOnFile)for(var c=0,u=a.accountsOnFile;c<u.length;c++){var d=u[c];n.push(d),r[d.id]=d}}}(t,this.basicPaymentProductGroups,this.accountsOnFile,this.basicPaymentProductGroupById,this.accountOnFileById)}}),define("connectsdk.BasicPaymentProducts",["require","exports","connectsdk.BasicPaymentProduct"],function(t,e,y){"use strict";return function(t){this.json=t,this.basicPaymentProducts=[],this.basicPaymentProductById={},this.basicPaymentProductByAccountOnFileId={},this.accountsOnFile=[],this.accountOnFileById={},function(t,e,n,i,r,o){if(t.paymentProducts)for(var s=0,a=t.paymentProducts;s<a.length;s++){var c=a[s],u=new y(c);if(e.push(u),(i[u.id]=u).accountsOnFile)for(var d=0,l=u.accountsOnFile;d<l.length;d++){var p=l[d];n.push(p),o[(r[p.id]=p).id]=u}}}(t,this.basicPaymentProducts,this.accountsOnFile,this.basicPaymentProductById,this.accountOnFileById,this.basicPaymentProductByAccountOnFileId)}}),define("connectsdk.BasicPaymentItems",["require","exports"],function(t,e){"use strict";return function(t,e){this.basicPaymentItems=[],this.basicPaymentItemById={},this.accountsOnFile=[],this.accountOnFileById={},function(t,e,n){if(e)for(var i={},r=0,o=t.basicPaymentProducts;r<o.length;r++){for(var s=o[r],a=!1,c=0,u=e.basicPaymentProductGroups;c<u.length;c++){var d=u[c];if(s.paymentProductGroup===d.id){a=!0,i[d.id]||(n.basicPaymentItems.push(d.copy()),i[d.id]=!0);break}}a||n.basicPaymentItems.push(s.copy())}else for(var l=0,p=t.basicPaymentProducts;l<p.length;l++){s=p[l];n.basicPaymentItems.push(s.copy())}for(var y=0,f=n.basicPaymentItems;y<f.length;y++){var h=f[y];if((n.basicPaymentItemById[h.id]=h).accountsOnFile)for(var m=0,g=h.accountsOnFile;m<g.length;m++){var P=g[m];n.accountsOnFile.push(P),n.accountOnFileById[P.id]=P}}}(t,e,this)}}),define("connectsdk.C2SCommunicatorConfiguration",["require","exports"],function(t,e){"use strict";return function(t,e){if(this.clientSessionId=t.clientSessionId,this.customerId=t.customerId,this.clientApiUrl=t.clientApiUrl,this.assetUrl=t.assetUrl,!this.clientApiUrl)throw new Error("This version of the connectSDK requires an clientApiUrl, which you did not provide.");if(!this.assetUrl)throw new Error("This version of the connectSDK requires an assetUrl, which you did not provide.");if(-1===this.clientApiUrl.indexOf("//"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");if(""!==(t=this.clientApiUrl.split("/"))[0]&&0!==t[0].indexOf("http"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");if(t=t.splice(3).join("/")){if("client"===t)this.clientApiUrl+="/"+e.split("/")[1];else if(0!==t.indexOf(e)||t.length!==e.length)throw new Error("This version of the connectSDK is only compatible with "+e+", you supplied: '"+t+"'")}else this.clientApiUrl+="/"+e}}),define("connectsdk.C2SPaymentProductContext",["require","exports"],function(t,e){"use strict";return function(t){this.totalAmount=t.totalAmount,this.countryCode=t.countryCode,this.isRecurring=t.isRecurring,this.currency=t.currency,void 0!==t.locale&&(this.locale=t.locale),this.isInstallments=t.isInstallments||!1,void 0!==t.accountOnFileId&&(this.accountOnFileId=t.accountOnFileId),void 0!==t.environment&&(this.environment=t.environment)}}),define("connectsdk.GooglePay",["require","exports","connectsdk.promise","connectsdk.Util"],function(t,e,l,n){"use strict";var p=n.getInstance();return function(){var r,e,o={},s="",a=[];function c(){return{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:a}}}function t(){return Object.assign({},c(),{tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:s,gatewayMerchantId:o.googlePay.gatewayMerchantId}}})}function u(){return{apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[t()],transactionInfo:{totalPriceStatus:"NOT_CURRENTLY_KNOWN",currencyCode:null==r?void 0:r.currency},merchantInfo:{merchantName:o.googlePay.merchantName}}}function d(){var t;return void 0===e&&(t="TEST","PROD"===r.environment&&(t="PRODUCTION"),window.google?e=new google.payments.api.PaymentsClient({environment:t}):console.error("The Google Pay API script was not loaded https://developers.google.com/pay/api/web/guides/tutorial#js-load")),e}this.isGooglePayAvailable=function(t,e,n){if(r=t,o=e,s=n.gateway,(a=n.networks)&&0<a.length){n=d();if(n){var i=new l;return n.isReadyToPay({apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[c()]}).then(function(t){var e,n;i.resolve(t.result),e=u(),n=d(),(t=o.googlePay).gatewayMerchantId&&t.merchantName?n.prefetchPaymentData(e):console.warn("Prefetching payment data was not triggered because of missing information. gatewayMerchantId: "+t.gatewayMerchantId+", merchantName: "+t.merchantName)}).catch(function(t){p.paymentProductsThatAreNotSupportedInThisBrowser.push(p.googlePayPaymentProductId),i.reject(t)}),i}return p.paymentProductsThatAreNotSupportedInThisBrowser.push(p.googlePayPaymentProductId),l.reject("The Google Pay API script was not loaded https://developers.google.com/pay/api/web/guides/tutorial#js-load")}return p.paymentProductsThatAreNotSupportedInThisBrowser.push(p.googlePayPaymentProductId),l.reject("There are no product networks available")},this.isMerchantIdProvided=function(t){return t&&t.googlePay&&t.googlePay.merchantId?!!t.googlePay.merchantId:(p.paymentProductsThatAreNotSupportedInThisBrowser.push(p.googlePayPaymentProductId),!1)}}}),define("connectsdk.IinDetailsResponse",["require","exports"],function(t,e){"use strict";return function(t,e){this.status=t,(this.json=e)&&(this.countryCode=e.countryCode,this.paymentProductId=e.paymentProductId,this.isAllowedInContext=e.isAllowedInContext,this.coBrands=e.coBrands)}}),define("connectsdk.net",["require","exports","connectsdk.promise"],function(t,e,a){"use strict";var n="function"==typeof"".trim?function(t){return t.trim()}:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},i=window.DOMParser?function(t){return(new DOMParser).parseFromString(t,"text/xml")}:function(t){var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e},r=(o.prototype.run=function(){var t=this;this.scriptTag=document.createElement("script"),this.scriptTag.id=this.methodName,this.scriptTag.src=this.url.replace("{callback}",this.methodName),this.scriptTag.onerror=function(){return t.failure()},document.body.appendChild(this.scriptTag)},o.prototype.teardown=function(){window[this.methodName]=null;try{delete window[this.methodName]}catch(t){}this.scriptTag&&document.body.removeChild(this.scriptTag)},o);function o(t,e,n){var i=this;this.url=t,this.success=e,this.failure=n,this.methodName="__connectsdk_jsonp_"+(new Date).getTime();window[this.methodName]=function(t){i.success(t),i.teardown()}}function c(){}return c.serialize=function(t){if(!t)return"";if("string"==typeof t)return t;var e,n=[];for(e in t)n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.join("&")},c.parseJSON=function(t){return"string"==typeof t&&t?(t=n(t),window.JSON.parse(t)):null},c.parseXML=function(t){return i(t)},c.ajax=function(t,e){var i=function(){if(!("undefined"==typeof XMLHttpRequest||"file:"===window.location.protocol&&window.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw new Error("Could not initialze xhr")}(),n=new a,r=void 0!==e?e:{};function o(){try{!function(){var t,e,n={Accept:"text/javascript, application/json, text/html, application/xml, text/xml, */*","Content-Type":"application/json"};for(t in r.headers=r.headers||{},n)r.headers.hasOwnProperty(t)||(r.headers[t]=n[t]);for(e in r.headers)i.setRequestHeader(e,r.headers[e])}(),i.send(r.postBody)}catch(t){r.error&&r.error()}}r.method=r.method?r.method.toLowerCase():"get",r.asynchronous=r.asynchronous||!0,r.postBody=r.postBody||"",i.onreadystatechange=function(){if(4==i.readyState){var t=i.mimeType||i.getResponseHeader("content-type")||"",e={status:i.status,responseText:i.responseText,success:200<=(e=i).status&&e.status<300||304==e.status||0==e.status&&!!e.responseText};if(/json/.test(t)?e.responseJSON=c.parseJSON(i.responseText):/xml/.test(t)&&(e.responseXML=c.parseXML(i.responseText)),r.callback)return r.callback(e,i);e.success?(r.success&&r.success(e,i),n.resolve(e)):(r.error&&r.error(e,i),n.reject(e))}var e},i.open(r.method,t,r.asynchronous),r.headers=r.headers||{},r.contentType&&(r.headers["Content-Type"]=r.contentType),"string"!=typeof r.postBody&&(r.postBody=c.serialize(r.postBody));var s={set:function(t,e){return r.headers=r.headers||{},r.headers[t]=e,s},send:function(t,e){return r.postBody=c.serialize(t),r.callback=e,o(),s},end:function(t){return r.callback=t,o(),s},data:function(t){return r.postBody=c.serialize(t),s},then:function(t,e){return s.end(),n.then(t,e),s}};return s},c.get=function(t,e){return(e=void 0===e?{}:e).method="get",c.ajax(t,e)},c.post=function(t,e){return(e=void 0===e?{}:e).method="post",c.ajax(t,e)},c.jsonp=function(t,e){var n=void 0!==e.failure?e.failure:function(){};new r(t,e.success,n).run()},c}),define("connectsdk.PublicKeyResponse",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.keyId=t.keyId,this.publicKey=t.publicKey}}),define("connectsdk.C2SCommunicator",["require","exports","connectsdk.ApplePay","connectsdk.GooglePay","connectsdk.IinDetailsResponse","connectsdk.net","connectsdk.promise","connectsdk.PublicKeyResponse","connectsdk.Util"],function(t,e,n,r,w,I,S,o,i){"use strict";var b=i.getInstance();return function(t,e){var s=this,c=t,u={},d=e,l=new r,p=new n,y={expirydate:"tel",string:"text",numericstring:"tel",integer:"number",expirationDate:"tel"};function i(t){return t&&(e="/",-1!==t.indexOf(e,t.length-e.length))?t:t+"/";var e}function f(t,e){return t=i(t),n=t,0===e.indexOf(n)?e:t+e;var n}function a(t){return i(c.clientApiUrl)+c.customerId+t}function h(t,e,n){n=(n=void 0===n?!0:n)&&e.locale?"&locale="+e.locale:"";return a(t+"?countryCode="+e.countryCode+"&isRecurring="+e.isRecurring+"&amount="+e.totalAmount+"&currencyCode="+e.currency+n)}function m(t,e,n){n=(n=void 0===n?!0:n)&&e.locale?e.locale+"_":"";return t+e.totalAmount+"_"+e.countryCode+"_"+n+e.isRecurring+"_"+e.currency}function g(t,e){for(var n=0,i=t.fields;n<i.length;n++){var r,o=i[n];for(r in o.type=o.displayHints&&o.displayHints.obfuscate?"password":y[o.type],o.dataRestrictions.validators)o.validators=o.validators||[],o.validators.push(r);o.displayHints&&o.displayHints.formElement&&"list"===o.displayHints.formElement.type&&(o.displayHints.formElement.list=!0),o.displayHints&&o.displayHints.tooltip&&o.displayHints.tooltip.image&&(o.displayHints.tooltip.image=f(e,o.displayHints.tooltip.image))}if(t.fields.sort(function(t,e){return(null!==(t=null===(t=t.displayHints)||void 0===t?void 0:t.displayOrder)&&void 0!==t?t:0)<(null!==(e=null===(e=e.displayHints)||void 0===e?void 0:e.displayOrder)&&void 0!==e?e:0)?-1:1}),t.displayHints.logo=f(e,t.displayHints.logo),t.accountsOnFile)for(var s=0,a=t.accountsOnFile;s<a.length;s++){var c=a[s];c.displayHints.logo=f(e,c.displayHints.logo)}return t}function P(t,e,n){for(var i=0,r=t["paymentProduct"+n];i<r.length;i++){var o=r[i];if(o.displayHints.logo=f(e,o.displayHints.logo),o.accountsOnFile)for(var s=0,a=o.accountsOnFile;s<a.length;s++){var c=a[s];c.displayHints.logo=f(e,c.displayHints.logo)}}return t["paymentProduct"+n].sort(function(t,e){return t.displayHints.displayOrder<e.displayHints.displayOrder?-1:1}),t}function v(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r&&r.id===e)return 1}}function k(t,e,n){b.filterOutProductsThatAreNotSupportedInThisBrowser(t),0===(u[n]=t).paymentProducts.length?e.reject("No payment products available"):e.resolve(t)}this.getBasicPaymentProducts=function(i,r){r=r||{};var t=(new Date).getTime(),o=m("getPaymentProducts-",i)+"_"+JSON.stringify(r);if(u[o])return S.resolve(u[o]);var s=new S,e=h("/products",i)+"&hide=fields&cacheBust="+t,t=b.getMetadata();return I.get(e).set("X-GCS-ClientMetaInfo",b.base64Encode(t)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e,n;t.success?(v((e=P(t.responseJSON,c.assetUrl,"s")).paymentProducts,b.applePayPaymentProductId)&&p.isApplePayAvailable(),v(e.paymentProducts,b.googlePayPaymentProductId)&&l.isMerchantIdProvided(r)?(n=function(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r&&r.id===e)return r.paymentProduct320SpecificData}}(e.paymentProducts,b.googlePayPaymentProductId),l.isGooglePayAvailable(i,r,n).then(function(){return k(e,s,o)},function(){return k(e,s,o)})):k(e,s,o)):s.reject(t.responseJSON)}),s},this.getBasicPaymentProductGroups=function(t){var e=(new Date).getTime(),n=m("getPaymentProductGroups-",t);if(u[n])return S.resolve(u[n]);var i=new S,t=h("/productgroups",t)+"&hide=fields&cacheBust="+e,e=b.getMetadata();return I.get(t).set("X-GCS-ClientMetaInfo",b.base64Encode(e)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e;t.success?(e=P(t.responseJSON,c.assetUrl,"Groups"),u[n]=e,i.resolve(e)):i.reject(t.responseJSON)}),i},this.getPaymentProduct=function(i,r,o){o=o||{};var t=(new Date).getTime(),s=m("getPaymentProduct-"+i,r)+"_"+JSON.stringify(o);if(-1<b.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(i))return S.reject({errorId:"48b78d2d-1b35-4f8b-92cb-57cc2638e901",errors:[{code:"1007",propertyName:"productId",message:"UNKNOWN_PRODUCT_ID",httpStatusCode:404}]});if(d&&d.id===i)return u[s]||(u[s]=g(d,c.assetUrl)),S.resolve(u[s]);if(u[s])return S.resolve(u[s]);var a=new S,e=h("/products/"+i,r);i===b.bancontactPaymentProductId&&o&&o.bancontact&&o.bancontact.forceBasicFlow&&(e+="&forceBasicFlow="+o.bancontact.forceBasicFlow),e+="&cacheBust="+t;t=b.getMetadata();return I.get(e).set("X-GCS-ClientMetaInfo",b.base64Encode(t)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e,n;t.success?(e=g(t.responseJSON,c.assetUrl),u[s]=e,i!==b.applePayPaymentProductId||p.isApplePayAvailable()?i===b.googlePayPaymentProductId&&l.isMerchantIdProvided(o)?(n=e.paymentProduct320SpecificData,l.isGooglePayAvailable(r,o,n).then(function(t){t?a.resolve(e):a.reject({message:"Google Pay is not available in the client",json:e})},function(t){a.reject({reason:t,json:e})})):a.resolve(e):a.reject({message:"Apple Pay is not available in the client",json:e})):a.reject(t.responseJSON)}),a},this.getPaymentProductGroup=function(t,e){var n=(new Date).getTime(),i=h("getPaymentProductGroup-"+t,e);if(d&&d.id===t)return u[i]||(u[i]=g(d,c.assetUrl)),S.resolve(u[i]);if(u[i])return S.resolve(u[i]);var r=new S,e=h("/productgroups/"+t,e)+"&cacheBust="+n,n=b.getMetadata();return I.get(e).set("X-GCS-ClientMetaInfo",b.base64Encode(n)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e;t.success?(e=g(t.responseJSON,c.assetUrl),u[i]=e,r.resolve(e)):r.reject(t.responseJSON)}),r},this.getPaymentProductIdByCreditCardNumber=function(t,i){var r="getPaymentProductIdByCreditCardNumber-"+t;if(u[r])return S.resolve(u[r]);if(6<=t.length){var o=new S,e=a("/services/getIINdetails"),n=b.getMetadata();return I.post(e).data(JSON.stringify(s.convertContextToIinDetailsContext(t,i))).set("X-GCS-ClientMetaInfo",b.base64Encode(n)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e,n;t.success?(e=t.responseJSON).hasOwnProperty("isAllowedInContext")?(n=!1!==e.isAllowedInContext?"SUPPORTED":"EXISTING_BUT_NOT_ALLOWED",n=new w(n,e),u[r]=n,o.resolve(n)):s.getPaymentProduct(e.paymentProductId,i).then(function(t){t=new w(t?"SUPPORTED":"UNSUPPORTED",e);u[r]=t,o.resolve(t)},function(){var t=new w("UNKNOWN",e);o.reject(t)}):(n=new w("UNKNOWN",t.responseJSON),o.reject(n))}),o}n=new w("NOT_ENOUGH_DIGITS");return S.resolve(n)},this.convertContextToIinDetailsContext=function(t,e){t={bin:t,paymentContext:{countryCode:e.countryCode,isRecurring:e.isRecurring,isInstallments:e.isInstallments,amountOfMoney:{amount:e.totalAmount,currencyCode:e.currency}}};return void 0!==e.accountOnFileId&&(t.accountOnFileId=e.accountOnFileId),t},this.getPublicKey=function(){var n="publicKey";if(u[n])return S.resolve(u[n]);var i=new S,t=a("/crypto/publickey"),e=b.getMetadata();return I.get(t).set("X-GCS-ClientMetaInfo",b.base64Encode(e)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){var e;t.success?(e=new o(t.responseJSON),u[n]=e,i.resolve(e)):i.reject(t.responseJSON)}),i},this.getPaymentProductNetworks=function(t,e){var n=m("paymentProductNetworks-"+t,e,!1);if(u[n])return S.resolve(u[n]);var i=new S,t=h("/products/"+t+"/networks",e,!1),e=b.getMetadata();return I.get(t).set("X-GCS-ClientMetaInfo",b.base64Encode(e)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?(u[n]=t.responseJSON,i.resolve(t.responseJSON)):i.reject(t.responseJSON)}),i},this.getPaymentProductDirectory=function(t,e,n){var i="getPaymentProductDirectory-"+t+"_"+e+"_"+n;if(u[i])return S.resolve(u[i]);var r=new S,n=a("/directory?countryCode="+n+"&currencyCode="+e),e=b.getMetadata();return I.get(n).set("X-GCS-ClientMetaInfo",b.base64Encode(e)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?(u[i]=t.responseJSON,r.resolve(t.responseJSON)):r.reject(t.responseJSON)}),r},this.convertAmount=function(t,e,n){var i="convertAmount-"+t+"_"+e+"_"+n;if(u[i])return S.resolve(u[i]);var r=new S,n=a("/services/convert/amount?source="+e+"&target="+n+"&amount="+t),t=b.getMetadata();return I.get(n).set("X-GCS-ClientMetaInfo",b.base64Encode(t)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?(u[i]=t.responseJSON,r.resolve(t.responseJSON)):r.reject(t.responseJSON)}),r},this.getThirdPartyPaymentStatus=function(t){var e=new S,n=a("/payments/"+t+"/thirdpartystatus"),t=b.getMetadata();return I.get(n).set("X-GCS-ClientMetaInfo",b.base64Encode(t)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?e.resolve(t.responseJSON):e.reject(t.responseJSON)}),e},this.getCustomerDetails=function(t,e){var n=function(t,e){var n,i=t;for(n in e)e.hasOwnProperty(n)&&(i+="_"+e[n].key+"_"+e[n].value);return i}("getCustomerDetails_"+t+"_"+e.countryCode,e.values);if(u[n])return S.resolve(u[n]);var i=new S,r=a("/products/"+t+"/customerDetails"),t=b.getMetadata();return I.post(r).data(JSON.stringify(e)).set("X-GCS-ClientMetaInfo",b.base64Encode(t)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?(u[n]=t.responseJSON,i.resolve(t.responseJSON)):i.reject(t.responseJSON)}),i},this.createPaymentProductSession=function(t,e){var n="createPaymentProductSession_"+t+"_"+e.validationURL+"_"+e.domainName+"_"+e.displayName;if(u[n])return S.resolve(u[n]);var i=new S,r=a("/products/"+t+"/sessions"),t={paymentProductSession302SpecificInput:{validationUrl:e.validationURL,domainName:e.domainName,displayName:e.displayName}},e=b.getMetadata();return I.post(r).data(JSON.stringify(t)).set("X-GCS-ClientMetaInfo",b.base64Encode(e)).set("Authorization","GCS v1Client:"+c.clientSessionId).end(function(t){t.success?(u[n]=t.responseJSON,i.resolve(t.responseJSON)):i.reject(t.responseJSON)}),i},this.initApplePayPayment=function(t,e,n){t=JSON.parse(JSON.stringify(t));return t.displayName=e.merchantName,e.acquirerCountry&&(t.acquirerCountry=e.acquirerCountry),t.networks=n,p.initPayment(t,s)},this.transformPaymentProductJSON=function(t){return g(t,c.assetUrl)}}}),define("connectsdk.ValidationRuleBoletoBancarioRequiredness",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.fiscalNumberLength=t.attributes.fiscalNumberLength}return n.prototype.validate=function(t,e){return(e=void 0===e?"":e).length===this.fiscalNumberLength&&0<t.length||e.length!==this.fiscalNumberLength},n.prototype.validateValue=function(t,e){var n=t.getUnmaskedValue("fiscalNumber");return((null==n?void 0:n.length)||0)!==this.fiscalNumberLength||!!t.getValue(e)},n}),define("connectsdk.ValidationRuleEmailAddress",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return n.prototype.validate=function(t){return new RegExp(/^[^@\.]+(\.[^@\.]+)*@([^@\.]+\.)*[^@\.]+\.[^@\.][^@\.]+$/i).test(t)},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleExpirationDate",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return n.prototype.validate=function(t){if(t=t.replace(/[^\d]/g,""),e=t,!/\d{4}|\d{6}$/g.test(e))return!1;if(4===t.length)n=[t.substring(0,2),"20"+t.substring(2,4)];else{if(6!==t.length)return!1;n=[t.substring(0,2),t.substring(2,6)]}var e=Number(n[0])-1,t=Number(n[1]),n=new Date(t,e,1);if(n.getMonth()!==Number(e)||n.getFullYear()!==Number(t))return!1;e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),e=new Date(e.getFullYear()+25,11,1);return t<=n&&n<=e},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleFixedList",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.allowedValues=t.attributes.allowedValues}return n.prototype.validate=function(t){for(var e=0,n=this.allowedValues;e<n.length;e++)if(n[e]===t)return!0;return!1},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleIban",["require","exports"],function(t,e){"use strict";function r(t){return t.replace(/[^\d\w]+/g,"").toUpperCase()}function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return n.prototype.validate=function(t){if("string"!=typeof(e=t)||!/^[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}$/.test(r(e)))return!1;for(var e,n=r(t).replace(/(^.{4})(.*)/,"$2$1").replace(/[A-Z]/g,function(t){return(t.charCodeAt(0)-55).toString()});2<n.length;)var i=n.slice(0,9),n=parseInt(i,10)%97+n.slice(i.length);return parseInt(n,10)%97==1},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleLength",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.minLength=t.attributes.minLength,this.maxLength=t.attributes.maxLength}return n.prototype.validate=function(t){return this.minLength<=t.length&&t.length<=this.maxLength},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return e?this.validate(e):0===this.minLength},n}),define("connectsdk.ValidationRuleLuhn",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return n.prototype.validate=function(t){var i=[[0,2,4,6,8,1,3,5,7,9],[0,1,2,3,4,5,6,7,8,9]],r=0;return t.replace(/\D+/g,"").replace(/[\d]/g,function(t,e,n){return r+=i[n.length-e&1][parseInt(t,10)],""}),r%10==0&&0<r},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleRange",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.minValue=t.attributes.minValue,this.maxValue=t.attributes.maxValue}return n.prototype.validate=function(t){t="number"==typeof t?t:parseInt(t);return!isNaN(t)&&(this.minValue<=t&&t<=this.maxValue)},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleRegularExpression",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.regularExpression=t.attributes.regularExpression}return n.prototype.validate=function(t){return new RegExp(this.regularExpression).test(t)},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleResidentIdNumber",["require","exports"],function(t,e){"use strict";for(var o=[],n=18;0<n;n--)o.push(Math.pow(2,n-1)%11);function i(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return i.prototype.validate=function(t){if(t.length<15)return!1;if(15==t.length)return/^\d{15}$/.test(t);if(18!==t.length)return!1;for(var e=0,n=0;n<t.length-1;n++)e+=Number(t.charAt(n))*o[n];var i=(12-e%11)%11,r=t.charAt(17);return i<10?i==Number(r):!!r&&"X"===r.toUpperCase()},i.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},i}),define("connectsdk.ValidationRuleTermsAndConditions",["require","exports"],function(t,e){"use strict";function n(t){this.json=t,this.type=t.type,this.errorMessageId=t.type}return n.prototype.validate=function(t){return!0===t||"true"===t},n.prototype.validateValue=function(t,e){e=t.getUnmaskedValue(e);return!!e&&this.validate(e)},n}),define("connectsdk.ValidationRuleFactory",["require","exports","connectsdk.ValidationRuleBoletoBancarioRequiredness","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleIban","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleResidentIdNumber","connectsdk.ValidationRuleTermsAndConditions"],function(t,e,n,i,r,o,s,a,c,u,d,l,p){"use strict";var y={EmailAddress:i,TermsAndConditions:p,ExpirationDate:r,FixedList:o,Length:a,Luhn:c,Range:u,RegularExpression:d,BoletoBancarioRequiredness:n,Iban:s,ResidentIdNumber:l};function f(){}return f.prototype.makeValidator=function(t){var e=t.type.charAt(0).toUpperCase()+t.type.slice(1);try{return new y[e](t)}catch(t){console.warn("no validator for ",e)}return null},f}),define("connectsdk.DataRestrictions",["require","exports","connectsdk.ValidationRuleFactory"],function(t,e,o){"use strict";return function(t){this.json=t,this.isRequired=t.isRequired,this.validationRules=[],this.validationRuleByType={},function(t,e,n){var i=new o;if(t.validators)for(var r in t.validators){r=i.makeValidator({type:r,attributes:t.validators[r]});r&&(e.push(r),n[r.type]=r)}}(t,this.validationRules,this.validationRuleByType)}}),define("connectsdk.JOSEEncryptor",["require","exports","node-forge"],function(t,e,d){"use strict";function l(t){return t=(t=(t=(t=d.util.encode64(t)).split("=")[0]).replace(/\+/g,"-")).replace(/\//g,"_")}function n(){}return n.prototype.encrypt=function(t,e){var n=JSON.stringify(t),i=l((c=e.keyId,JSON.stringify({alg:"RSA-OAEP",enc:"A256CBC-HS512",kid:c}))),r=d.random.getBytesSync(64),o=l((u=e.publicKey,u=d.util.decode64(u),u=d.util.createBuffer(u,"raw"),u=d.asn1.fromDer(u),d.pki.publicKeyFromAsn1(u)).encrypt(r,"RSA-OAEP")),s=r.substring(0,32),a=r.substring(32),t=d.random.getBytesSync(16),c=l(t),n=(e=n,u=a,r=t,(u=d.cipher.createCipher("AES-CBC",u)).start({iv:r}),u.update(d.util.createBuffer(e)),u.finish(),u.output.bytes()),a=l(n),u=(r=i,e=8*d.util.createBuffer(r).length(),(r=d.util.createBuffer()).putInt32(0),r.putInt32(e),r.bytes()),u=(e=s,r=i,s=t,t=n,n=u,(u=d.util.createBuffer()).putBytes(r),u.putBytes(s),u.putBytes(t),u.putBytes(n),n=u.bytes(),(u=d.hmac.create()).start("sha512",e),u.update(n),u.digest().bytes());return i+"."+o+"."+c+"."+a+"."+l(u.substring(0,u.length/2))},n}),define("connectsdk.ValueMappingElement",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.displayName=t.displayName,this.value=t.value}}),define("connectsdk.FormElement",["require","exports","connectsdk.ValueMappingElement"],function(t,e,o){"use strict";return function(t){this.json=t,this.type=t.type,this.valueMapping=[],function(t,e){if(t.valueMapping)for(var n=0,i=t.valueMapping;n<i.length;n++){var r=i[n];e.push(new o(r))}}(t,this.valueMapping)}}),define("connectsdk.Tooltip",["require","exports"],function(t,e){"use strict";return function(t){this.json=t,this.image=t.image,this.label=t.label}}),define("connectsdk.PaymentProductFieldDisplayHints",["require","exports","connectsdk.FormElement","connectsdk.Tooltip"],function(t,e,n,i){"use strict";return function(t){this.json=t,this.displayOrder=t.displayOrder,t.formElement&&(this.formElement=new n(t.formElement)),this.label=t.label,this.mask=t.mask,this.obfuscate=t.obfuscate,this.placeholderLabel=t.placeholderLabel,this.preferredInputType=t.preferredInputType,this.tooltip=t.tooltip?new i(t.tooltip):void 0,this.alwaysShow=t.alwaysShow,this.wildcardMask=t.mask?t.mask.replace(/9/g,"*"):""}}),define("connectsdk.PaymentProductField",["require","exports","connectsdk.DataRestrictions","connectsdk.MaskingUtil","connectsdk.PaymentProductFieldDisplayHints"],function(t,e,n,r,i){"use strict";function o(t){var a=this;this.json=t,this.displayHints=t.displayHints?new i(t.displayHints):"",this.dataRestrictions=new n(t.dataRestrictions),this.id=t.id,this.type=t.type;var c=[];this.getErrorCodes=function(t){return t&&(c=[],a.isValid(t)),c},this.getErrorMessageIds=function(t){return t&&(c=[],a.validateValue(t)),c},this.isValid=function(t){var e=a.dataRestrictions.validationRules,n=!1,i=a.applyMask(t);t=a.removeMask(i.formattedValue);for(var r=0,o=e;r<o.length;r++){var s=o[r];s.validate(t)||(n=!0,c.push(s.errorMessageId))}return!n},this.validateValue=function(t){for(var e=!1,n=0,i=a.dataRestrictions.validationRules;n<i.length;n++){var r=i[n];r.validateValue(t,a.id)||(e=!0,c.push(r.errorMessageId))}return!e}}return o.prototype.applyMask=function(t,e){var n=new r,i=this.displayHints?this.displayHints.mask:void 0;return n.applyMask(i,t,e)},o.prototype.applyWildcardMask=function(t,e){var n=new r,i=this.displayHints?this.displayHints.wildcardMask:void 0;return n.applyMask(i,t,e)},o.prototype.removeMask=function(t){var e=new r,n=this.displayHints?this.displayHints.mask:void 0;return e.removeMask(n,t)},o}),define("connectsdk.PaymentProduct",["require","exports","connectsdk.BasicPaymentProduct","connectsdk.PaymentProductField"],function(t,e,n,s){"use strict";var i;function r(t){var e=i.call(this,t)||this;return e.json=t,e.paymentProductFields=[],e.paymentProductFieldById={},e.fieldsWarning=t.fieldsWarning,function(t,e,n){if(t.fields)for(var i=0,r=t.fields;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.id]=o}}(t,e.paymentProductFields,e.paymentProductFieldById),e}return __extends(r,i=n),r}),define("connectsdk.PaymentRequest",["require","exports"],function(t,e){"use strict";function n(t){var r,o,s=this,e=t,a={},n=!1;this.setValue=function(t,e){a[t]=e},this.setTokenize=function(t){n=t},this.getTokenize=function(){return n},this.getErrorMessageIds=function(){return s.validate().map(function(t){return t.errorMessageId})},this.getValue=function(t){return a[t]},this.getValues=function(){return a},this.getMaskedValue=function(t){var e=r.paymentProductFieldById[t];if(e){t=s.getValue(t);if(void 0!==t)return e.applyMask(t).formattedValue}},this.getMaskedValues=function(){var t,e={};for(t in a){var n=r.paymentProductFieldById[t].applyMask(s.getValue(t));e[t]=n.formattedValue}return e},this.getUnmaskedValue=function(t){var e=r.paymentProductFieldById[t];if(e){t=s.getValue(t);if(void 0!==t){t=e.applyMask(t).formattedValue;return e.removeMask(t)}}},this.getUnmaskedValues=function(){var t,e={};for(t in a){var n,i=r.paymentProductFieldById[t];i&&(n=i.applyMask(s.getValue(t)).formattedValue,e[t]=i.removeMask(n))}return e},this.setPaymentProduct=function(t){r=t},this.getPaymentProduct=function(){return r},this.setAccountOnFile=function(t){if(t)for(var e=0,n=t.attributes;e<n.length;e++){var i=n[e];"MUST_WRITE"!==i.status&&delete a[i.key]}o=t||void 0},this.getAccountOnFile=function(){return o},this.getClientSessionID=function(){return e}}return n.prototype.isValid=function(){return!!this.getPaymentProduct()&&0===this.validate().length},n.prototype.validate=function(){var n=this.getPaymentProduct();if(!n)throw new Error("Error validating PaymentRequest, please set a paymentProduct first.");var t,i=[],e=this.getValues(),r=this;for(t in e)!function(t){var e=n.paymentProductFieldById[t];e&&i.push.apply(i,e.getErrorMessageIds(r).map(function(t){return{fieldId:e.id,errorMessageId:t}}))}(t);var o=this.getAccountOnFile();o&&o.paymentProductId!==n.id&&(o=void 0);for(var s=0,a=n.paymentProductFields;s<a.length;s++){var c=a[s];c.dataRestrictions.isRequired&&(this.getValue(c.id)||function(t){t=null==o?void 0:o.attributeByKey[t];return!!t&&"MUST_WRITE"!==t.status}(c.id)||i.push({fieldId:c.id,errorMessageId:"required"}))}return i},n}),define("connectsdk.Encryptor",["require","exports","node-forge","connectsdk.JOSEEncryptor","connectsdk.promise","connectsdk.Util"],function(t,e,a,o,s,n){"use strict";var c=n.getInstance();return function(n){this.encrypt=function(t){if(!t.getPaymentProduct())return s.reject("no paymentProduct set");var e=t.validate();if(0!==e.length)return s.reject(e);var i=function(t){var e={clientSessionId:t.getClientSessionID(),nonce:a.util.bytesToHex(a.random.getBytesSync(16)),paymentProductId:t.getPaymentProduct().id,tokenize:t.getTokenize(),paymentValues:[],collectedDeviceInformation:c.collectDeviceInformation()},n=t.getAccountOnFile();n&&(e.accountOnFileId=n.id);for(var i=t.getUnmaskedValues(),r=0,o=Object.getOwnPropertyNames(i);r<o.length;r++){var s=o[r];"length"!==s&&e.paymentValues.push({key:s,value:i[s]})}return e}(t),r=new s;return n.then(function(t){var e=new o;try{var n=e.encrypt(i,t);r.resolve(n)}catch(t){r.reject(t)}},function(t){r.reject(t)}),r}}}),define("connectsdk.PaymentProductGroup",["require","exports","connectsdk.BasicPaymentProductGroup","connectsdk.PaymentProductField"],function(t,e,n,s){"use strict";var i;function r(t){var e=i.call(this,t)||this;return e.json=t,e.paymentProductFields=[],e.paymentProductFieldById={},function(t,e,n){if(t.fields)for(var i=0,r=t.fields;i<r.length;i++){var o=r[i],o=new s(o);e.push(o),n[o.id]=o}}(t,e.paymentProductFields,e.paymentProductFieldById),e}return __extends(r,i=n),r}),define("connectsdk.PaymentItem",["require","exports"],function(t,e){"use strict";e.__esModule=!0}),define("connectsdk.Session",["require","exports","connectsdk.BasicPaymentItems","connectsdk.BasicPaymentProductGroups","connectsdk.BasicPaymentProducts","connectsdk.C2SCommunicator","connectsdk.C2SCommunicatorConfiguration","connectsdk.C2SPaymentProductContext","connectsdk.Encryptor","connectsdk.PaymentProduct","connectsdk.PaymentProductGroup","connectsdk.PaymentRequest","connectsdk.promise"],function(t,e,u,d,l,p,y,f,h,m,g,P,v){"use strict";return function(t,e){var r,o,i,n,s=this,a=new y(t,"client/v1"),c=new p(a,e);this.clientApiUrl=a.clientApiUrl,this.assetUrl=a.assetUrl,this.getBasicPaymentProducts=function(e,t){var n=new v,i=new f(e);return c.getBasicPaymentProducts(i,t).then(function(t){r=e;t=new l(t);n.resolve(t)},function(t){n.reject(t)}),n},this.getBasicPaymentProductGroups=function(e){var n=new v,t=new f(e);return c.getBasicPaymentProductGroups(t).then(function(t){r=e;t=new d(t);n.resolve(t)},function(t){n.reject(t)}),n},this.getBasicPaymentItems=function(t,e,n){var i=new v;return e?s.getBasicPaymentProducts(t,n).then(function(e){s.getBasicPaymentProductGroups(t).then(function(t){t=new u(e,t);i.resolve(t)},function(t){i.reject(t)})},function(t){i.reject(t)}):s.getBasicPaymentProducts(t,n).then(function(t){t=new u(t,null);i.resolve(t)},function(t){i.reject(t)}),i},this.getPaymentProduct=function(t,e,n){var i=new v,e=new f(r||e);return c.getPaymentProduct(t,e,n).then(function(t){o=new m(t),i.resolve(o)},function(t){o=null,i.reject(t)}),i},this.getPaymentProductGroup=function(t,e){var n=new v,e=new f(r||e);return c.getPaymentProductGroup(t,e).then(function(t){i=new g(t),n.resolve(i)},function(t){i=null,n.reject(t)}),n},this.getIinDetails=function(t,e){t=8<=(t=t.replace(/ /g,"")).length?t.substring(0,8):t.substring(0,6);e=new f(r||e);return c.getPaymentProductIdByCreditCardNumber(t,e)},this.getPublicKey=function(){return c.getPublicKey()},this.getPaymentProductNetworks=function(t,e){var n=new v,i=new f(e);return c.getPaymentProductNetworks(t,i).then(function(t){r=e,n.resolve(t)},function(t){n.reject(t)}),n},this.getPaymentProductDirectory=function(t,e,n){return c.getPaymentProductDirectory(t,e,n)},this.convertAmount=function(t,e,n){return c.convertAmount(t,e,n)},this.getPaymentRequest=function(){return n=n||new P(a.clientSessionId)},this.getEncryptor=function(){var t=c.getPublicKey();return new h(t)},this.getThirdPartyPaymentStatus=function(t){return c.getThirdPartyPaymentStatus(t)},this.getCustomerDetails=function(t,e){return c.getCustomerDetails(t,e)},this.createPaymentProductSession=function(t,e){return c.createPaymentProductSession(t,e)},this.createApplePayPayment=function(t,e,n){return c.initApplePayPayment(t,e,n)},this.transformPaymentProductJSON=function(t){return new m(c.transformPaymentProductJSON(t))},this.transformPaymentProductGroupJSON=function(t){return new g(c.transformPaymentProductJSON(t))}}}),define("connectsdk.core",["require","exports","connectsdk.AccountOnFile","connectsdk.AccountOnFileDisplayHints","connectsdk.ApplePay","connectsdk.Attribute","connectsdk.BasicPaymentItems","connectsdk.BasicPaymentProduct","connectsdk.BasicPaymentProductGroup","connectsdk.BasicPaymentProductGroups","connectsdk.BasicPaymentProducts","connectsdk.C2SCommunicator","connectsdk.C2SCommunicatorConfiguration","connectsdk.C2SPaymentProductContext","connectsdk.DataRestrictions","connectsdk.Encryptor","connectsdk.FormElement","connectsdk.GooglePay","connectsdk.IinDetailsResponse","connectsdk.JOSEEncryptor","connectsdk.LabelTemplateElement","connectsdk.MaskedString","connectsdk.MaskingUtil","connectsdk.net","connectsdk.PaymentProduct","connectsdk.PaymentProduct302SpecificData","connectsdk.PaymentProduct320SpecificData","connectsdk.PaymentProduct863SpecificData","connectsdk.PaymentProductField","connectsdk.PaymentProductFieldDisplayHints","connectsdk.PaymentProductGroup","connectsdk.PaymentRequest","connectsdk.promise","connectsdk.PublicKeyResponse","connectsdk.Session","connectsdk.Tooltip","connectsdk.Util","connectsdk.ValidationRuleBoletoBancarioRequiredness","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFactory","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleIban","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleResidentIdNumber","connectsdk.ValidationRuleTermsAndConditions","connectsdk.ValueMappingElement"],function(t,e,n,i,r,o,s,a,c,u,d,l,p,y,f,h,m,g,P,v,k,w,I,S,b,O,C,A,R,N,x,M,B,T,V,j,E,F,D,q,U,G,H,_,J,L,z,K,X,W){"use strict";W={AccountOnFile:n,AccountOnFileDisplayHints:i,ApplePay:r,Attribute:o,BasicPaymentItems:s,BasicPaymentProduct:a,BasicPaymentProductGroup:c,BasicPaymentProductGroups:u,BasicPaymentProducts:d,C2SCommunicator:l,C2SCommunicatorConfiguration:p,C2SPaymentProductContext:y,DataRestrictions:f,Encryptor:h,FormElement:m,GooglePay:g,IinDetailsResponse:P,JOSEEncryptor:v,LabelTemplateElement:k,MaskedString:w,MaskingUtil:I,net:S,get:S.get,post:S.post,jsonp:S.jsonp,PaymentProduct:b,PaymentProduct302SpecificData:O,PaymentProduct320SpecificData:C,PaymentProduct863SpecificData:A,PaymentProductField:R,PaymentProductFieldDisplayHints:N,PaymentProductGroup:x,PaymentRequest:M,Promise:B,PublicKeyResponse:T,Session:V,Tooltip:j,Util:E,ValidationRuleBoletoBancarioRequiredness:F,ValidationRuleEmailAddress:D,ValidationRuleExpirationDate:q,ValidationRuleFactory:U,ValidationRuleFixedList:G,ValidationRuleIban:H,ValidationRuleLength:_,ValidationRuleLuhn:J,ValidationRuleRange:L,ValidationRuleRegularExpression:z,ValidationRuleResidentIdNumber:K,ValidationRuleTermsAndConditions:X,ValueMappingElement:W};return("undefined"==typeof window?this:window).connectsdk=W});
//# sourceMappingURL=connectsdk.noEncrypt.min.js.map
